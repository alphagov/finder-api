module CaseHelpers

  def consumer_open
    {
      "slug" => "cma-cases/investigation-into-the-distribution-of-road-fuels-in-parts-of-scotland",
      "title" => "Investigation into the distribution of road fuels in parts of Scotland",
      "summary" => "In January 2013, the OFT launched a formal investigation into the distribution of road fuels in the Western Isles of Scotland by GB Oils Limited ('GB Oils'). The investigation is under Chapter II of the Competition Act 1998 and relates to a suspected exclusionary abuse of a dominant position in the relevant market.",
      "body" => "#  Investigation into the distribution of road fuels in parts of Scotland \n\n\n\n**Case opened:** January 2013  \n**Case References**\\: MP-SIP/0034/\n\n## Summary of work\n\nIn January 2013, the OFT launched a formal investigation into the\ndistribution of road fuels in the Western Isles of Scotland by GB Oils\nLimited (\\'GB Oils\\'). Since then the OFT has taken the decision to\ncontinue with the investigation and also to extend it to cover certain\nmatters in  the Shetland Islands. The investigation is under Chapter II\nof the Competition Act 1998 and relates to a suspected exclusionary\nabuses of a dominant position in the relevant market.\n\nOn 27 September 2013, GB Oils\\' name was changed to Certas Energy UK\nLimited (\\'Certas\\').\n\nThe subject matter of the investigation concerns the contractual\narrangements for wholesale supply of road fuels in the Western Isles\noffered by GB Oils/Certas (where applicable trading under the name\nScottish Fuels or through one of its group companies), the rebates paid\nto filling station customers in the Western Isles by GB Oils/Certas and\nany other payments that may have been made to filling station customers\nin the Western Isles by GB Oils/Certas.\n\nThe current investigation does not relate to excessive pricing and has\nnot been prompted by the OFT\\'s previous review of pricing, [Petrol and\nDiesel Pricing in the Scottish\nIslands](/OFTwork/markets-work/othermarketswork/scottishfuelpricing/).\n\n\nThis case is at an early stage and no assumption should be made that\nthere has been an infringement of competition law.\n\n## Case timetable\n\nFirst published: 18 January 2013\n\n|  **Milestone** | ** Date** |\n| Investigation opened | 8 January 2013 (actual) |\n| First Stop/Go Decision | April 2013  \n (actual) |\n| Further investigation: information gathering, including issuance of formal or informal information requests and parties\\' responses | May 2013 -June 2013 (actual) |\n| OFT analysis and review of parties\\' responses to information requests | June 2013- July 2013 (actual) |\n| Decision to proceed with investigation | July 2013  \n (actual) |\n| Further analysis and information gathering | July -Sept 2013 (actual) |\n| Decision to proceed with investigation | October 2013 (actual)  |\n| Investigation outcome (issue of Statement of Objections; case closure - See [Procedural Guidance](/shared_oft/policy/OFT1263rev) (pdf 876kb) | By end March 2014 (estimate) |\n\n   \n  \n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n**Notes**\n\n* The OFT has not reached a view as to whether there is sufficient\n  evidence of infringement of competition law for it to issue a\n  Statement of Objections to any of the parties under investigation. Not\n  all cases result in the OFT issuing a Statement of Objections.\n* If the OFT issues a Statement of Objections, it will provide the\n  addressee(s) of that Statement of Objections with an opportunity to\n  make written and oral representations. Further detail of the OFT\\'s\n  Procedures in Competition Act cases is available here: Procedural\n  Guidance. \n* Changes to the timing of original entries in the case timetable will\n  be made where the estimated timing in the original timetable changes.\n\n## Team Leader\n\nBrian Jackson (020 7211 8446,\n[brian.jackson@oft.gsi.gov.uk](mailto:brian.jackson@oft.gsi.gov.uk))\n\n\n## Project Director\n\nJames Macbeth (020 7211 8958,\n[james.macbeth@oft.gsi.gov.uk](mailto:james.macbeth@oft.gsi.gov.uk\n\"james.macbeth@oft.gsi.gov.uk\"))\n\n\n## Senior Responsible Officer\n\nAnn Pope (020 7211 8786,\n[ann.pope@oft.gsi.gov.uk](mailto:ann.pope@oft.gsi.gov.uk))\n\n\n## Media enquiries\n\nAny media enquiries should be directed to a member of our [Press\nOffice](/news-and-updates/)\n\n\n   \n  \n  \n",
      "opened_date" => "2006-7-14",
      "case_type" => "ca98-and-civil-cartels",
      "case_state" => "open",
      "market_sector" => "distribution-and-service-industries",
      "updated_at" => "2014-04-15",
    }
  end

  def mergers_closed
    {
      "slug" => "cma-cases/healthcorp-druginc-merger-inquiry",
      "title" => "Heathcorp / Druginc merger inquiry",
      "summary" => "Inquiry into the Healthcorp / Druginc merger",
      "body" => "# Phase 1\n\nThe investigation",
      "opened_date" => "2005-12-30",
      "closed_date" => "2006-03-01",
      "case_type" => "mergers",
      "case_state" => "closed",
      "market_sector" => "pharmaceuticals",
      "outcome_type" => "mergers-phase-1-found-not-to-qualify",
      "updated_at" => "2014-04-15",
    }
  end

  def civil_cartel_closed
    {
      "slug" => "cma-cases/investigtion-into-the-distribution-f-road-fuels-in-parts-of-scotland",
      "title" => "Investigation into the distribution of road fuels in parts of Scotland",
      "summary" => "In January 2013, the OFT launched a formal investigation into the distribution of road fuels in the Western Isles of Scotland by GB Oils Limited ('GB Oils'). The investigation is under Chapter II of the Competition Act 1998 and relates to a suspected exclusionary abuse of a dominant position in the relevant market.",
      "body" => "#  Investigation into the distribution of road fuels in parts of Scotland \n\n\n\n**Case opened:** January 2013  \n**Case References**\\: MP-SIP/0034/\n\n## Summary of work\n\nIn January 2013, the OFT launched a formal investigation into the\ndistribution of road fuels in the Western Isles of Scotland by GB Oils\nLimited (\\'GB Oils\\'). Since then the OFT has taken the decision to\ncontinue with the investigation and also to extend it to cover certain\nmatters in  the Shetland Islands. The investigation is under Chapter II\nof the Competition Act 1998 and relates to a suspected exclusionary\nabuses of a dominant position in the relevant market.\n\nOn 27 September 2013, GB Oils\\' name was changed to Certas Energy UK\nLimited (\\'Certas\\').\n\nThe subject matter of the investigation concerns the contractual\narrangements for wholesale supply of road fuels in the Western Isles\noffered by GB Oils/Certas (where applicable trading under the name\nScottish Fuels or through one of its group companies), the rebates paid\nto filling station customers in the Western Isles by GB Oils/Certas and\nany other payments that may have been made to filling station customers\nin the Western Isles by GB Oils/Certas.\n\nThe current investigation does not relate to excessive pricing and has\nnot been prompted by the OFT\\'s previous review of pricing, [Petrol and\nDiesel Pricing in the Scottish\nIslands](/OFTwork/markets-work/othermarketswork/scottishfuelpricing/).\n\n\nThis case is at an early stage and no assumption should be made that\nthere has been an infringement of competition law.\n\n## Case timetable\n\nFirst published: 18 January 2013\n\n|  **Milestone** | ** Date** |\n| Investigation opened | 8 January 2013 (actual) |\n| First Stop/Go Decision | April 2013  \n (actual) |\n| Further investigation: information gathering, including issuance of formal or informal information requests and parties\\' responses | May 2013 -June 2013 (actual) |\n| OFT analysis and review of parties\\' responses to information requests | June 2013- July 2013 (actual) |\n| Decision to proceed with investigation | July 2013  \n (actual) |\n| Further analysis and information gathering | July -Sept 2013 (actual) |\n| Decision to proceed with investigation | October 2013 (actual)  |\n| Investigation outcome (issue of Statement of Objections; case closure - See [Procedural Guidance](/shared_oft/policy/OFT1263rev) (pdf 876kb) | By end March 2014 (estimate) |\n\n   \n  \n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n \n\n**Notes**\n\n* The OFT has not reached a view as to whether there is sufficient\n  evidence of infringement of competition law for it to issue a\n  Statement of Objections to any of the parties under investigation. Not\n  all cases result in the OFT issuing a Statement of Objections.\n* If the OFT issues a Statement of Objections, it will provide the\n  addressee(s) of that Statement of Objections with an opportunity to\n  make written and oral representations. Further detail of the OFT\\'s\n  Procedures in Competition Act cases is available here: Procedural\n  Guidance. \n* Changes to the timing of original entries in the case timetable will\n  be made where the estimated timing in the original timetable changes.\n\n## Team Leader\n\nBrian Jackson (020 7211 8446,\n[brian.jackson@oft.gsi.gov.uk](mailto:brian.jackson@oft.gsi.gov.uk))\n\n\n## Project Director\n\nJames Macbeth (020 7211 8958,\n[james.macbeth@oft.gsi.gov.uk](mailto:james.macbeth@oft.gsi.gov.uk\n\"james.macbeth@oft.gsi.gov.uk\"))\n\n\n## Senior Responsible Officer\n\nAnn Pope (020 7211 8786,\n[ann.pope@oft.gsi.gov.uk](mailto:ann.pope@oft.gsi.gov.uk))\n\n\n## Media enquiries\n\nAny media enquiries should be directed to a member of our [Press\nOffice](/news-and-updates/)\n\n\n   \n  \n  \n",
      "opened_date" => "2003-12-30",
      "closed_date" => "2004-03-01",
      "case_type" => "ca98-and-civil-cartels",
      "case_state" => "closed",
      "market_sector" => "distribution-and-service-industries",
      "outcome_type" => "ca98-infringement-chapter-i",
      "updated_at" => "2014-04-15",
    }
  end

  def all_documents
    [
      consumer_open,
      mergers_closed,
      civil_cartel_closed,
    ]
  end

  def put_new_document(slug, document_attributes)
    put("/finders/#{slug}", document: document_attributes)
  end

  def put_all_documents
    responses = all_documents
      .map { |d| [ d.fetch("slug"), d ] }
      .map { |(slug, doc)| [slug, MultiJson.dump(doc)] }
      .map { |(slug, doc)| put_new_document(slug, doc) }
  end

  def put_all_documents_excluding(criteria)
    responses = put_documents(
      all_documents.reject { |d| criteria.all? { |k, v| d[k] == v } }
    )
  end

  def put_documents(docs)
    docs
      .map { |d| [ d.fetch("slug"), d ] }
      .map { |(slug, doc)| [slug, MultiJson.dump(doc)] }
      .map { |(slug, doc)| put_new_document(slug, doc) }
  end
end
